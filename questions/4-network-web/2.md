# HTTPS에 대해 설명해주세요.

## HTTPS

HTTPS는 웹 브라우저와 웹 사이트 간에 데이터를 전송하는 데 사용되는 기본 프로토콜인 HTTP의 보안 버전이다. HTTPS는 암호화 프로토콜(SSL/TLS)을 사용하여 통신을 암호화한다.

- HTTP vs HTTPS
  ![http-https](https://github.com/COW-edu/backend-cs-study/assets/79684339/8ff83348-2e84-46ff-a7bd-022b0939a4f5)

> \*SSL(Secure Socket Layer) vs TLS(Transport Layer Security)  
> TLS1.0은 SSL 3.0을 계승한다. 즉 TLS는 SSL의 새로운 버전 중 하나이다. 실질적으로 TLS를 사용하지만 SSL 이라는 이름으로 많이 부른다.

## 암호화 방식

![암호화](https://github.com/COW-edu/backend-cs-study/assets/79684339/2b09153e-dead-4bb6-8e9a-977a9aa91e78)

### 1. **대칭키 암호화 방식**

대칭키 암호화 방식이란 하나의 암호화키로 평문을 암호화하고, 다시 암호문을 원해의 평문으로 복호화할 때 사용하는 방식이다. 대칭키 암호화 방식은 키를 단 하나만 사용하는 간편함이 있지만, 키를 분실하거나 도난을 당한다면 내 암호문을 누군가가 복호화하여 볼 수 있다는 치명적인 단점이 있다.

### 2. **공개키 암호화 방식**

공개키 암호화 방식은 두 개(공개키, 개인키)의 키를 한 쌍으로 각각 암호화/복호화에 사용한다. 일반적으로 공개키로 암호화한 것을 개인키로 복호화한다. 개인키를 먼저 만들고, 여기서 공개키를 파생하여 한 쌍의 키를 만들기 때문에 키페어라고 부른다. 만약 같은 쌍이 아닌 다른 키를 사용하려 한다면 암호화/복호화가 불가능하다.

## SSL/TLS 핸드셰이크

> \*핸드셰이크란 통신에서 연결을 설정하기 위한 과정이다.
> ![핸드셰이크](https://github.com/COW-edu/backend-cs-study/assets/79684339/af741fa1-a228-4e9f-b598-7a16c675b5d7)

1. **Client Hello**

   웹 사이트 접속에 HTTPS를 사용하는 브라우저는 Client Hello 단계에서 다음 정보들을 보냅니다.

   - 브라우저가 사용하는 SSL 혹은 TLS 버전 정보
   - 브라우저가 지원하는 암호화 방식 모음(cipher suite)
   - 브라우저가 순간적으로 생성한 임의의 난수(숫자)
   - 만약 이전에 SSL 핸드 셰이크가 완료된 상태라면, 그때 생성된 세션 아이디(Session ID)
   - 기타 정보

2. **Server Hello**

   웹 서버는 1번에 응답하면서 아래의 정보를 클라이언트에 제공합니다.

   - 브라우저의 암호화 방식 정보 중에서 서버가 지원하고 선택한 암호화 방식(cipher suite)
   - 서버의 공개키가 담긴 SSL 인증서. 인증서는 CA의 비밀키로 암호화되어 발급된 상태입니다.
   - 서버가 순간적으로 생성한 임의의 난수(숫자)
   - 클라이언트 인증서 요청(선택사항)

3. **서버 인증서 확인**

   브라우저는 서버의 SSL 인증서가 올바른지 확인합니다. 대부분 브라우저에는 공신력 있는 CA들의 정보와 CA가 만든 공개키가 이미 설치되어 있습니다. 서버가 보낸 SSL 인증서가 정말 CA가 만든 것인지를 확인하기 위해, 내장된 CA 공개키로 암호화된 인증서를 복호화합니다. 정상적으로 복호화되었다면 CA가 발급한 것이 증명되는 셈입니다. 만약 등록된 CA가 아니거나, 등록된 CA가 만든 인증서처럼 꾸몄다면 이 과정에서 발각이 되며 브라우저 경고를 보냅니다.

4. **Premaster Secret 전송**

   브라우저는 자신이 생성한 난수와 서버의 난수를 사용하여 premaster secret을 만듭니다. 웹 서버 인증서에 딸려 온 웹 사이트의 공개키로 이것을 암호화하여 서버로 전송합니다.

5. **Premaster Secret 복호화**

   복호화한 값을 master secret 값으로 저장합니다. 이것을 사용하여 방금 브라우저와 만들어진 연결에 고유한 값을 부여하기 위한 세션키를 생성합니다. 세션키는 대칭키 암호화에 사용할 키입니다. 이것으로 브라우저와 서버 사이에 주고받는 데이터를 암호화하고 복호화합니다.

6. **SSL handshake 종료**

   브라우저와 서버의 SSL 핸드셰이크가 정상적으로 완료되었습니다. 이제는 웹상에서 데이터를 세션키를 사용해 암호화/복호화하며, HTTPS 프로토콜을 통해 주고받을 수 있습니다.
